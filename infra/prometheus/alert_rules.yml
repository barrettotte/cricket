groups:
  - name: alert_rules
    interval: 1m
    rules:
      - alert: grafana_down
        expr: time() - container_last_seen{name="grafana"} > 15
        for: 1m
          # havent seen container for over 15 seconds and this has been true for one minute
        labels:
          severity: critical
        annotations:
          summary: Container "{{ $labels.name }}" is not running
          description: 'Container "{{ $labels.name }}" has been down for more than {{ $value | printf "%.0f" }} second(s)'

      - alert: too_hot
        expr: cricket_temperature_fahrenheit{app="cricket"} > 75.0
        for: 1m
        labels:
          severity: critical
        annotations:
          summary: I'm being cooked alive in here!
          description: 'Temperature threshold {{ $value | printf "%.0f" }}Â°F hit for over one minute.'

      - alert: sensor_failure
        expr: |
          cricket_temperature_fahrenheit{app="cricket"} == 0.0
            or cricket_humidity_percent{app="cricket"} == 0.0
        for: 1m
        labels:
          severity: critical
        annotations:
          summary: DHT Sensor Malfunction
          description: Failed to read DHT sensor data for more than a minute.

      - alert: sensor_down
        expr: scrape_samples_scraped{job="cricket"} == 0
        for: 1m
        labels:
          severity: critical
        annotations:
          summary: DHT Sensor Offline
          description: DHT sensor appears to be offline for more than a minute.
